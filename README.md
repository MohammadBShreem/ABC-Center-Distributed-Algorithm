# ABC-Center-Distributed-Algorithm

authors:
  * [Mohammad SHREM](https://www.linkedin.com/in/mohammadbshreem/) <mohammad.shrem@edu.univ-fcomte.fr>
  * [Mariam AL KHALAF]() <mariam.al_khalaf@edu.univ-fcomte.fr>

supervisor:
  * [Prof. Benoit PIRANDA](https://www.femto-st.fr/fr/personnel-femto/bpiranda) <benoit.piranda@univ-fcomte.fr>

project relaized in [VisibleSim](https://github.com/VisibleSim/VisibleSim)

---

## Overview
AbcCode is a program generated by the VisibleSim BlockCode Generator. It demonstrates the implementation of a distributed system where modules A, B, and C are elected sequentially based on their relative distances in a Blinky Blocks network. The program performs actions such as message passing, distance calculations, and module coloring to represent states visually.

## Features
- **Distributed Election**: Implements a distributed mechanism to elect module A, B, and C based on distances.
- **Visual State Representation**: Uses colors (RED, YELLOW, BLUE, BROWN) to represent different states of modules.
- **Message Passing**: Employs message passing for communication between modules.
- **Center Identification**: Determines the central module between B and C based on distance.

## Key Components

### Files
- **AbcCode.cpp**: Main source file containing the implementation of the program logic.
- **AbcCode.hpp**: Header file defining the class and functions used in `AbcCode.cpp`.

### Classes
- **AbcCode**: Derived from `BlinkyBlocksBlockCode`, encapsulates the logic for module election and communication.

### Functions
1. **startup**: Initializes module states and starts the election process if the module is A.
2. **myGoFuncFromX**: Handles "go" messages for module X (A or B), propagates the distance, and sets the parent.
3. **myBackFuncFromX**: Handles "back" messages for module X, updates the longest child distance, and propagates acknowledgment.
4. **myLightFuncFromX**: Handles "Light" messages for module X, triggers the next stage of the election, and updates module state.
5. **parseUserBlockElements**: Parses user-defined block elements to identify the leader (A).
6. **onInterfaceDraw**: Displays information about the modules, distances, and states on the interface.

## Pseudocode for "AbcCode" Project

### Phase 1: Finding Module B
1. If the current module is the initial module (module A):
   - Set the color to indicate it as the starting point (RED).
   - Set `distanceToA` to 0.
   - Begin the "go" phase by sending an `AGo` message to all neighbors.
   - Process Phase A.

2. On receiving an `AGradient` message with distance and round info:
   - If the received round is higher, reset the module state.
   - If `distanceToA` is greater than the received distance:
     - Update `parentModule` and set `distanceToA`.
   - Forward `AGradient` to all neighbors except `parentModule`.

3. If all responses are received:
   - Send an `ABack` message back to `parentModule` with `distanceToA`.
   - Process Phase A Back.

4. On receiving an `ABack` message with `distanceToA`:
   - Update the maximum `distanceToA` and set `portToB` for communication.
   - If all responses are received:
     - If this is `moduleA`, it will set itself to RED and send an `ElectB` message through `portToB`.

### Phase 2: Finding Module C
1. On receiving an `ElectB` message:
   - If thereâ€™s no further node in `portToB` direction:
     - Elect this module as `moduleB` and set its color to indicate election (YELLOW).
   - Begin the B phase to propagate distances by sending `BGo` messages to neighbors.
   - Process Phase B.

2. On receiving a `BGradient` message:
   - Similar to A, forward distance to neighbors and update `distanceToB`.
   - On receiving all responses, send a `BBack` message to `parentModule`.
   - Process Phase B Back.

3. Similar to Phase A Back:
   - Update maximum distance for B and send `ElectC` through the furthest port.

### Phase 3: Finding and Lighting the Center
1. Repeat the steps for `C Gradient`, `C Back`, and `Elect Center` to:
   - Elect module C (BLUE) as the furthest node from module B.
   - Finally, elect the center module based on distances between B and C, and set its color (BROWN).

2. Finalize the election process.

## Colors
- **RED**: Module A.
- **YELLOW**: Module B.
- **BLUE**: Module C.
- **BROWN**: Central module between B and C.

## Result for "ABC-Center-Distributed-Algorithm"

<div align="center">
<img src="https://github.com/user-attachments/assets/1e9bcbc6-99b8-4e5e-b134-e8a3e39a8fb9" alt="Result of the Program" width="600">
<br>
<i>Figure 1: Result of the Program</i>
</div>

<div align="center">
<a href="https://github.com/user-attachments/assets/003678c2-142d-48c9-b363-0f40791bf930">
<img src="https://github.com/user-attachments/assets/04f4124d-959f-44de-a473-25ec5a5eef63" alt="Result on First Configuration" width="600">
</a>
<br>
<i>Figure 2: Result of the Program on First Configuration</i>
</div>

<div align="center">
<a href="https://github.com/user-attachments/assets/5f510ed0-a24e-4fa4-808b-0a46e226dc09">
<img src="https://github.com/user-attachments/assets/1a8c6cca-5d1d-4d5e-aa2e-d22f6afc2a61" alt="Result on Second Configuration" width="600">
</a>
<br>
<i>Figure 3: Result of the Program on Second Configuration</i>
</div>

## Conclusion
AbcCode effectively demonstrates a distributed election mechanism in a Blinky Blocks network. By dividing the process into three clear phases, the program ensures modularity and clarity in its execution. The use of color-based visualization aids in understanding the state of the network and the elected modules at each stage. This approach can be extended to more complex distributed systems for tasks such as network optimization, fault tolerance, or dynamic topology adjustments.
